<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png"><link rel="mask-icon" href="/images/logo.svg" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:new URL("http://note.niubishanshan.top").hostname,root:"/",scheme:"Gemini",version:"7.7.0",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!1,show_result:!1,style:null},back2top:{enable:!0,sidebar:!1,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{appID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},path:"search.json",motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}}}</script><meta name="description" content="上一步提到, 对于我配出来的 webpack 领导并不是很认可, 那只好…"><meta property="og:type" content="article"><meta property="og:title" content="第二步, 面试官-谈谈你对模块化的理解"><meta property="og:url" content="http://note.niubishanshan.top/blog/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E9%85%8D-webpack/blog/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E9%85%8D%20webpack/%E7%AC%AC%E4%BA%8C%E6%AD%A5,%20%E9%9D%A2%E8%AF%95%E5%AE%98-%E8%B0%88%E8%B0%88%E4%BD%A0%E5%AF%B9%E6%A8%A1%E5%9D%97%E5%8C%96%E7%9A%84%E7%90%86%E8%A7%A3/index.html"><meta property="og:site_name" content="圈圈的笔记"><meta property="og:description" content="上一步提到, 对于我配出来的 webpack 领导并不是很认可, 那只好…"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://handle-note-img.niubishanshan.top/20240627231859.png"><meta property="og:image" content="https://handle-note-img.niubishanshan.top/20240627232015.png"><meta property="og:image" content="https://handle-note-img.niubishanshan.top/20240627232022.png"><meta property="og:image" content="https://handle-note-img.niubishanshan.top/20240627232035.png"><meta property="og:image" content="https://handle-note-img.niubishanshan.top/20240627232043.png"><meta property="og:image" content="https://handle-note-img.niubishanshan.top/20240627232155.png"><meta property="og:image" content="https://handle-note-img.niubishanshan.top/20240627232203.png"><meta property="og:image" content="https://handle-note-img.niubishanshan.top/20240627232213.png"><meta property="og:image" content="https://handle-note-img.niubishanshan.top/20240627232231.png"><meta property="og:image" content="https://handle-note-img.niubishanshan.top/20240627232247.png"><meta property="og:image" content="https://handle-note-img.niubishanshan.top/20240627232257.png"><meta property="og:image" content="https://handle-note-img.niubishanshan.top/20240627232332.png"><meta property="article:published_time" content="2019-01-28T14:56:57.000Z"><meta property="article:modified_time" content="2024-06-27T15:23:33.977Z"><meta property="article:author" content="圈圈的圈"><meta property="article:tag" content="blog"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://handle-note-img.niubishanshan.top/20240627231859.png"><link rel="canonical" href="http://note.niubishanshan.top/blog/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E9%85%8D-webpack/blog/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E9%85%8D%20webpack/%E7%AC%AC%E4%BA%8C%E6%AD%A5,%20%E9%9D%A2%E8%AF%95%E5%AE%98-%E8%B0%88%E8%B0%88%E4%BD%A0%E5%AF%B9%E6%A8%A1%E5%9D%97%E5%8C%96%E7%9A%84%E7%90%86%E8%A7%A3/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0}</script><title>第二步, 面试官-谈谈你对模块化的理解 | 圈圈的笔记</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div> <a target="_blank" rel="noopener" href="https://github.com/luoquanquan" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513;color:#fff;position:absolute;top:0;border:0;right:0" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-meta"><div><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">圈圈的笔记</span><span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle">路漫漫其修远兮, 吾将上下而求索</p></div><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-fw fa-home"></i> 首页</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i> 标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i> 分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i> 归档</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i> 关于</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> 搜索</a></li></ul></nav><div class="site-search"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="搜索..." spellcheck="false" type="text" id="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"></div></div><div class="search-pop-overlay"></div></div></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content"><div class="posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="http://note.niubishanshan.top/blog/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E9%85%8D-webpack/blog/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E9%85%8D%20webpack/%E7%AC%AC%E4%BA%8C%E6%AD%A5,%20%E9%9D%A2%E8%AF%95%E5%AE%98-%E8%B0%88%E8%B0%88%E4%BD%A0%E5%AF%B9%E6%A8%A1%E5%9D%97%E5%8C%96%E7%9A%84%E7%90%86%E8%A7%A3/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.png"><meta itemprop="name" content="圈圈的圈"><meta itemprop="description" content="技术学习, 读书笔记, 生活感悟 ~"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="圈圈的笔记"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> 第二步, 面试官-谈谈你对模块化的理解</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2019-01-28 22:56:57" itemprop="dateCreated datePublished" datetime="2019-01-28T22:56:57+08:00">2019-01-28</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i></span> <span class="post-meta-item-text">更新于</span> <time title="修改时间：2024-06-27 23:23:33" itemprop="dateModified" datetime="2024-06-27T23:23:33+08:00">2024-06-27</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/blog/" itemprop="url" rel="index"><span itemprop="name">blog</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/blog/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E9%85%8D-webpack/" itemprop="url" rel="index"><span itemprop="name">手把手带你配 webpack</span></a></span></span><span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">阅读次数：</span><span id="busuanzi_value_page_pv"></span></span></div></header><div class="post-body" itemprop="articleBody"><blockquote><p><a target="_blank" rel="noopener" href="https://fe-note.niubishanshan.top/blog/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E9%85%8D-webpack/blog/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E9%85%8D%20webpack/%E7%AC%AC%E4%B8%80%E6%AD%A5,%20%E5%81%9A%E4%B8%80%E4%B8%AA%E9%AB%98%E7%BA%A7%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E5%B8%88/">上一步</a>提到, 对于我配出来的 webpack 领导并不是很认可, 那只好…</p></blockquote><span id="more"></span><p><img src="https://handle-note-img.niubishanshan.top/20240627231859.png" alt="20240627231859"></p><h2 id="尴尬的面试题"><a href="#尴尬的面试题" class="headerlink" title="尴尬的面试题"></a>尴尬的面试题</h2><p>问: 你知道的 js 模块化方案有哪些?<br><br>答: js 的模块化一般来说有 Commonjs AMD(CMD) ESModule 等, Commonjs 使用的同步加载一般用于 node, AMD(CMD) 由于是异步加载所以普遍用在前端. ESModule 旨在实现前后端模块化的统一. 言简意骇, 点到为止. 简直优秀…</p><p><img src="https://handle-note-img.niubishanshan.top/20240627232015.png" alt="20240627232015"></p><p>问: 那么为什么同步的 Commonjs 要用在 node, 异步的 AMD 要用在前端呢?<br><br>答: node 应用程序运行在服务器上, 程序通过文件系统可以直接读取到各个模块的文件, 特点是响应快速不会因为同步而阻塞了程序的运行. 前端项目运行在浏览器中, 每个模块都要通过 http 请求加载 js 文件, 受到网络等因素的影响如果同步的话会使得浏览器出现”假死”的情况 — 也就是卡住了. 影响用户体验. 整场邂逅已经完全 cover 住了有没有 ^_^.</p><p><img src="https://handle-note-img.niubishanshan.top/20240627232022.png" alt="20240627232022"></p><p>问: 那你听过 webpack 吗? 知道 webpack 是怎么实现模块化的吗?<br><br>答: webpack <a target="_blank" rel="noopener" href="https://juejin.im/post/5c473d11e51d452c8e6d57f2">看这里</a>, webpack 的模块化其实就是把 ES6 模块化代码转码成 Commonjs 的形式(咦, 有点慌, 但是面试题就是这么背的呀), 从而兼容浏览器的. 前后矛盾, 已经开始有点鸡动啦, 但是强忍着希望蒙混过关…</p><p><img src="https://handle-note-img.niubishanshan.top/20240627232035.png" alt="20240627232035"></p><p>问: 好的, 既然你说 Commonjs 的同步方式前端不适用, 为什么 webpack 转码的 Commonjs 形式以后可以前端运行呢?<br><br>答: emmmmm</p><p>面试官: 那要不今天的面试就先到这儿吧, 你先回去等通知…<br><br>我: hmmmmm<br><img src="https://handle-note-img.niubishanshan.top/20240627232043.png" alt="20240627232043"></p><h2 id="webpack-到底做了什么"><a href="#webpack-到底做了什么" class="headerlink" title="webpack 到底做了什么"></a>webpack 到底做了什么</h2><p>一遍又一遍的执行了 webpack 命令, 一次又一次的研究生成的 bundle.js. 嗯哼? 所有的 js 模块都打包到了一个 bundle.js 里了, 根本没有分模块加载, 那还管他丫的同步还是异步. js 文件直接读取到内存里一步到位, 比 nodejs 需要读取文件还要方便…</p><p>那么, webpack 到底是怎样把这么多文件组合成一个 bundle.js 文件的呢? 仔细想一下, 还是把天书和大家一起学习一下吧, 要不感觉这个系列的文章会变成表情包分享教程!</p><p><img src="https://handle-note-img.niubishanshan.top/20240627232155.png" alt="20240627232155"></p><p>接下来我会分享 Commonjs 和 es6 Module 两种模块化方式 webpack 的处理, 如果有小伙伴对这两种方式有疑问, 请 google 一下. 其实所谓的模块化无非就是给一段代码添加了两把钥匙实现和其他代码的通信, 相互调用, 通过 require 获取引入其他模块的能力, 通过 export 实现向其他模块输出方法的功能.</p><h3 id="commonjs-模块化的处理"><a href="#commonjs-模块化的处理" class="headerlink" title="commonjs 模块化的处理"></a>commonjs 模块化的处理</h3><p>首先添加一个 <code>npm script</code> 修改 package.json 如下图:</p><p><img src="https://handle-note-img.niubishanshan.top/20240627232203.png" alt="20240627232203"></p><p>添加完成后<a target="_blank" rel="noopener" href="https://github.com/luoquanquan/webpack-show/commit/9b0f910858176fa488fb1fee75e9b895bd9bfdda">代码</a>, 就可以抛弃 <code>./node_modules/.bin/webpack</code> 这个命令了, 打包时只需要 <code>npm run build</code> 即可.</p><p><img src="https://handle-note-img.niubishanshan.top/20240627232213.png" alt="20240627232213"></p><p>搭建项目代码, <a target="_blank" rel="noopener" href="https://github.com/luoquanquan/webpack-show/commit/298684fc2fb388fa2b04f8276d71023f40ca01df">代码地址</a>, 其中, index.js 内容:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> foo = <span class="built_in">require</span>(<span class="string">&quot;./foo&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(foo);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;我是高级前端工程师~&quot;</span>);</span><br></pre></td></tr></table></figure><p>foo.js 内容:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;quanquan&quot;</span>,</span><br><span class="line">    <span class="attr">job</span>: <span class="string">&quot;fe&quot;</span>,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>纯纯粹粹的 Commonjs 代码, 执行 <code>npm run build</code> 后, 我们再看看打包后的 bundle.js. (ps: 添加了部分注释)</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">function</span> (<span class="params">modules</span>) &#123;</span><br><span class="line">    <span class="comment">// 缓存模块对象</span></span><br><span class="line">    <span class="keyword">var</span> installedModules = &#123;&#125;;</span><br><span class="line">    <span class="comment">// 模拟 commonjs 实现的 require</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">__webpack_require__</span>(<span class="params">moduleId</span>) &#123;</span><br><span class="line">        <span class="comment">// require 模块时先判断是否已经缓存, 已经缓存的模块直接返回</span></span><br><span class="line">        <span class="keyword">if</span> (installedModules[moduleId]) &#123;</span><br><span class="line">            <span class="keyword">return</span> installedModules[moduleId].<span class="property">exports</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// (模拟)创建一个模块, 并把新模块的引用保存到缓存中</span></span><br><span class="line">        <span class="keyword">var</span> <span class="variable language_">module</span> = (installedModules[moduleId] = &#123;</span><br><span class="line">            <span class="comment">// 模块 id</span></span><br><span class="line">            <span class="attr">i</span>: moduleId,</span><br><span class="line">            <span class="comment">// 模块是否已加载</span></span><br><span class="line">            <span class="attr">l</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="comment">// 模块主体内容, 会被重写</span></span><br><span class="line">            <span class="attr">exports</span>: &#123;&#125;,</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">// 执行以下模块的包装函数, 并把模块内部的 this 志向模块主体</span></span><br><span class="line">        modules[moduleId].<span class="title function_">call</span>(</span><br><span class="line">            <span class="variable language_">module</span>.<span class="property">exports</span>,</span><br><span class="line">            <span class="variable language_">module</span>,</span><br><span class="line">            <span class="variable language_">module</span>.<span class="property">exports</span>,</span><br><span class="line">            __webpack_require__</span><br><span class="line">        );</span><br><span class="line">        <span class="comment">// 将模块标记为已加载</span></span><br><span class="line">        <span class="variable language_">module</span>.<span class="property">l</span> = <span class="literal">true</span>;</span><br><span class="line">        <span class="comment">// 返回模块主体内容</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">module</span>.<span class="property">exports</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 向外暴露所有的模块</span></span><br><span class="line">    __webpack_require__.<span class="property">m</span> = modules;</span><br><span class="line">    <span class="comment">// 向外暴露已缓存的模块</span></span><br><span class="line">    __webpack_require__.<span class="property">c</span> = installedModules;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 下边两个方法暂时还没有用到</span></span><br><span class="line">    <span class="comment">// define getter function for harmony exports</span></span><br><span class="line">    __webpack_require__.<span class="property">d</span> = <span class="keyword">function</span> (<span class="params"><span class="built_in">exports</span>, name, getter</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!__webpack_require__.<span class="title function_">o</span>(<span class="built_in">exports</span>, name)) &#123;</span><br><span class="line">            <span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(<span class="built_in">exports</span>, name, &#123;</span><br><span class="line">                <span class="attr">configurable</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">enumerable</span>: <span class="literal">true</span>,</span><br><span class="line">                <span class="attr">get</span>: getter,</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// getDefaultExport function for compatibility with non-harmony modules</span></span><br><span class="line">    __webpack_require__.<span class="property">n</span> = <span class="keyword">function</span> (<span class="params"><span class="variable language_">module</span></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> getter =</span><br><span class="line">            <span class="variable language_">module</span> &amp;&amp; <span class="variable language_">module</span>.<span class="property">__esModule</span></span><br><span class="line">                ? <span class="keyword">function</span> <span class="title function_">getDefault</span>(<span class="params"></span>) &#123;</span><br><span class="line">                      <span class="keyword">return</span> <span class="variable language_">module</span>[<span class="string">&quot;default&quot;</span>];</span><br><span class="line">                  &#125;</span><br><span class="line">                : <span class="keyword">function</span> <span class="title function_">getModuleExports</span>(<span class="params"></span>) &#123;</span><br><span class="line">                      <span class="keyword">return</span> <span class="variable language_">module</span>;</span><br><span class="line">                  &#125;;</span><br><span class="line">        __webpack_require__.<span class="title function_">d</span>(getter, <span class="string">&quot;a&quot;</span>, getter);</span><br><span class="line">        <span class="keyword">return</span> getter;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Object.prototype.hasOwnProperty.call 这个就没啥好解释的啦</span></span><br><span class="line">    <span class="comment">// js 权威指南上有说</span></span><br><span class="line">    __webpack_require__.<span class="property">o</span> = <span class="keyword">function</span> (<span class="params">object, property</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">hasOwnProperty</span>.<span class="title function_">call</span>(object, property);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// __webpack_public_path__</span></span><br><span class="line">    <span class="comment">// 这个暂时还没有用到</span></span><br><span class="line">    __webpack_require__.<span class="property">p</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="comment">// Load entry module and return exports</span></span><br><span class="line">    <span class="comment">// 准备工作做完了, require 一下入口模块, 让项目跑起来</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">__webpack_require__</span>((__webpack_require__.<span class="property">s</span> = <span class="number">0</span>));</span><br><span class="line">&#125;)(</span><br><span class="line">    <span class="comment">/********  华丽的分割线 上边时 webpack 初始化代码, 下边是我们写的模块代码 ***************/</span></span><br><span class="line">    [</span><br><span class="line">        <span class="comment">/* 模块 0 对应 index.js */</span></span><br><span class="line">        <span class="comment">/***/</span> <span class="keyword">function</span> (<span class="params"><span class="variable language_">module</span>, <span class="built_in">exports</span>, __webpack_require__</span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> foo = <span class="title function_">__webpack_require__</span>(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(foo);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;我是高级前端工程师~&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">/***/</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">/* 模块 1 对应 foo.js */</span></span><br><span class="line">        <span class="comment">/***/</span> <span class="keyword">function</span> (<span class="params"><span class="variable language_">module</span>, <span class="built_in">exports</span></span>) &#123;</span><br><span class="line">            <span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">                <span class="attr">name</span>: <span class="string">&quot;quanquan&quot;</span>,</span><br><span class="line">                <span class="attr">job</span>: <span class="string">&quot;fe&quot;</span>,</span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line">            <span class="comment">/***/</span></span><br><span class="line">        &#125;,</span><br><span class="line">    ]</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>原来 webpack 就是把我们写的代码用一个一个的包装函数包装了起来, 再执行<strong>webpack_require</strong>的时候调用一下包装函数. 通过包装函数内部的代码重写了参数中参数 module 的 exports 属性, 获取到我们编写的模块的主体代码.</p><p>所以我们看到了 <code>index.js</code> 包装后的代码为:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span>(<span class="params"><span class="variable language_">module</span>, <span class="built_in">exports</span>, __webpack_require__</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> foo = <span class="title function_">__webpack_require__</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(foo);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;我是高级前端工程师~&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>foo.js</code> 包装后的代码为:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span>(<span class="params"><span class="variable language_">module</span>, <span class="built_in">exports</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&#x27;quanquan&#x27;</span>,</span><br><span class="line">        <span class="attr">job</span>: <span class="string">&#x27;fe&#x27;</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>由于 index.js 中有 <code>require(&#39;./foo&#39;)</code> 所以 index.js 生成的包装函数参数中多了<strong>webpack_require</strong>用于导入 foo 模块, 从头到尾看下来, 之前的天书似乎不再晦涩难懂了. 当然这一块内容需要大家稍微动动脑筋思考一下. 也希望大家把自己的想法和问题放到评论区, 我们一起讨论.</p><p><img src="https://handle-note-img.niubishanshan.top/20240627232231.png" alt="20240627232231"></p><h3 id="es6-Module-模块化的处理"><a href="#es6-Module-模块化的处理" class="headerlink" title="es6 Module 模块化的处理"></a>es6 Module 模块化的处理</h3><p>改动我们的项目代码为 es6 模块化代码, 首先修改 <code>index.js</code>:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> foo <span class="keyword">from</span> <span class="string">&quot;./foo&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(foo);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;我是高级前端工程师~&quot;</span>);</span><br></pre></td></tr></table></figure><p>其次修改 <code>foo.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;quanquan&quot;</span>,</span><br><span class="line">    <span class="attr">job</span>: <span class="string">&quot;fe&quot;</span>,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>最后就是命令行执行 <code>npm run build</code> 进行打包啦. 打包完成后 <code>bundle.js</code> 内容如下(经过优化):</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">function</span> (<span class="params">modules</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> installedModules = &#123;&#125;;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">__webpack_require__</span>(<span class="params">moduleId</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (installedModules[moduleId]) &#123;</span><br><span class="line">            <span class="keyword">return</span> installedModules[moduleId].<span class="property">exports</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> <span class="variable language_">module</span> = (installedModules[moduleId] = &#123;</span><br><span class="line">            <span class="attr">i</span>: moduleId,</span><br><span class="line">            <span class="attr">l</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">exports</span>: &#123;&#125;,</span><br><span class="line">        &#125;);</span><br><span class="line">        modules[moduleId].<span class="title function_">call</span>(</span><br><span class="line">            <span class="variable language_">module</span>.<span class="property">exports</span>,</span><br><span class="line">            <span class="variable language_">module</span>,</span><br><span class="line">            <span class="variable language_">module</span>.<span class="property">exports</span>,</span><br><span class="line">            __webpack_require__</span><br><span class="line">        );</span><br><span class="line">        <span class="variable language_">module</span>.<span class="property">l</span> = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">module</span>.<span class="property">exports</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    __webpack_require__.<span class="property">m</span> = modules;</span><br><span class="line">    __webpack_require__.<span class="property">c</span> = installedModules;</span><br><span class="line">    __webpack_require__.<span class="property">d</span> = <span class="keyword">function</span> (<span class="params"><span class="built_in">exports</span>, name, getter</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!__webpack_require__.<span class="title function_">o</span>(<span class="built_in">exports</span>, name)) &#123;</span><br><span class="line">            <span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(<span class="built_in">exports</span>, name, &#123;</span><br><span class="line">                <span class="attr">configurable</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">enumerable</span>: <span class="literal">true</span>,</span><br><span class="line">                <span class="attr">get</span>: getter,</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    __webpack_require__.<span class="property">n</span> = <span class="keyword">function</span> (<span class="params"><span class="variable language_">module</span></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> getter =</span><br><span class="line">            <span class="variable language_">module</span> &amp;&amp; <span class="variable language_">module</span>.<span class="property">__esModule</span></span><br><span class="line">                ? <span class="keyword">function</span> <span class="title function_">getDefault</span>(<span class="params"></span>) &#123;</span><br><span class="line">                      <span class="keyword">return</span> <span class="variable language_">module</span>[<span class="string">&quot;default&quot;</span>];</span><br><span class="line">                  &#125;</span><br><span class="line">                : <span class="keyword">function</span> <span class="title function_">getModuleExports</span>(<span class="params"></span>) &#123;</span><br><span class="line">                      <span class="keyword">return</span> <span class="variable language_">module</span>;</span><br><span class="line">                  &#125;;</span><br><span class="line">        __webpack_require__.<span class="title function_">d</span>(getter, <span class="string">&quot;a&quot;</span>, getter);</span><br><span class="line">        <span class="keyword">return</span> getter;</span><br><span class="line">    &#125;;</span><br><span class="line">    __webpack_require__.<span class="property">o</span> = <span class="keyword">function</span> (<span class="params">object, property</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">hasOwnProperty</span>.<span class="title function_">call</span>(object, property);</span><br><span class="line">    &#125;;</span><br><span class="line">    __webpack_require__.<span class="property">p</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">__webpack_require__</span>((__webpack_require__.<span class="property">s</span> = <span class="number">0</span>));</span><br><span class="line">&#125;)([</span><br><span class="line">    <span class="keyword">function</span> (<span class="params"><span class="variable language_">module</span>, __webpack_exports__, __webpack_require__</span>) &#123;</span><br><span class="line">        <span class="string">&quot;use strict&quot;</span>;</span><br><span class="line">        <span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(__webpack_exports__, <span class="string">&quot;__esModule&quot;</span>, &#123;</span><br><span class="line">            <span class="attr">value</span>: <span class="literal">true</span>,</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">var</span> __WEBPACK_IMPORTED_MODULE_0__foo__ = <span class="title function_">__webpack_require__</span>(<span class="number">1</span>);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(__WEBPACK_IMPORTED_MODULE_0__foo__[<span class="string">&quot;a&quot;</span>]);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;我是高级前端工程师~&quot;</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="keyword">function</span> (<span class="params"><span class="variable language_">module</span>, __webpack_exports__, __webpack_require__</span>) &#123;</span><br><span class="line">        <span class="string">&quot;use strict&quot;</span>;</span><br><span class="line">        __webpack_exports__[<span class="string">&quot;a&quot;</span>] = &#123;</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&quot;quanquan&quot;</span>,</span><br><span class="line">            <span class="attr">job</span>: <span class="string">&quot;fe&quot;</span>,</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;,</span><br><span class="line">]);</span><br></pre></td></tr></table></figure><p>打包的结果仍然是天书式的代码, 还好和 commonjs 模块化方式大同小异. webpack 初始化代码完成相同.</p><p><code>index.js</code> 生成的包裹代码为:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span>(<span class="params"><span class="variable language_">module</span>, __webpack_exports__, __webpack_require__</span>) &#123;</span><br><span class="line">	<span class="string">&quot;use strict&quot;</span>;</span><br><span class="line">	<span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(__webpack_exports__, <span class="string">&quot;__esModule&quot;</span>, &#123; <span class="attr">value</span>: <span class="literal">true</span> &#125;);</span><br><span class="line">	<span class="keyword">var</span> __WEBPACK_IMPORTED_MODULE_0__foo__ = <span class="title function_">__webpack_require__</span>(<span class="number">1</span>);</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(__WEBPACK_IMPORTED_MODULE_0__foo__[<span class="string">&quot;a&quot;</span>]);</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;我是高级前端工程师~&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>foo.js</code> 生成的包裹代码为:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span>(<span class="params"><span class="variable language_">module</span>, __webpack_exports__, __webpack_require__</span>) &#123;</span><br><span class="line">	<span class="string">&quot;use strict&quot;</span>;</span><br><span class="line">	__webpack_exports__[<span class="string">&quot;a&quot;</span>] = (&#123;</span><br><span class="line">		<span class="attr">name</span>: <span class="string">&#x27;quanquan&#x27;</span>,</span><br><span class="line">		<span class="attr">job</span>: <span class="string">&#x27;fe&#x27;</span>,</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>不难发现, 和 commonjs 不同的地方:</p><ul><li>首先, 包装函数的参数之前的 <code>module.exports</code> 变成了<code>__webpack_exports__</code></li><li>其次, 在使用了 es6 模块导入语法(import)的地方, 给<code>__webpack_exports__</code>添加了属性<code>__esModule</code></li><li>其余的部分和 commonjs 类似</li></ul><p>我们发现, commonjs 中咩有用到的 <code>__webpack_require__.n</code> 这个方法还是没有用到, 这难道是废方法? 那岂不是可以给 webpack 提个 issue, 参与过得开源项目不再是空白. 美滋滋…</p><p><img src="https://handle-note-img.niubishanshan.top/20240627232247.png" alt="20240627232247"></p><p>要是这样都能搭上这种国际开源项目的班车, 岂不是太过容易了呢?</p><p><img src="https://handle-note-img.niubishanshan.top/20240627232257.png" alt="20240627232257"></p><h3 id="es6-Module-CommonJs-混合使用"><a href="#es6-Module-CommonJs-混合使用" class="headerlink" title="es6 Module CommonJs 混合使用"></a>es6 Module CommonJs 混合使用</h3><p>修改 <code>foo.js</code> 内容如下:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;quanquan&quot;</span>,</span><br><span class="line">    <span class="attr">job</span>: <span class="string">&quot;fe&quot;</span>,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>打包的结果为:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/******/</span> (<span class="keyword">function</span> (<span class="params">modules</span>) &#123;</span><br><span class="line">    <span class="comment">// webpackBootstrap</span></span><br><span class="line">    <span class="comment">/******/</span> <span class="comment">// The module cache</span></span><br><span class="line">    <span class="comment">/******/</span> <span class="keyword">var</span> installedModules = &#123;&#125;;</span><br><span class="line">    <span class="comment">/******/</span></span><br><span class="line">    <span class="comment">/******/</span> <span class="comment">// The require function</span></span><br><span class="line">    <span class="comment">/******/</span> <span class="keyword">function</span> <span class="title function_">__webpack_require__</span>(<span class="params">moduleId</span>) &#123;</span><br><span class="line">        <span class="comment">/******/</span></span><br><span class="line">        <span class="comment">/******/</span> <span class="comment">// Check if module is in cache</span></span><br><span class="line">        <span class="comment">/******/</span> <span class="keyword">if</span> (installedModules[moduleId]) &#123;</span><br><span class="line">            <span class="comment">/******/</span> <span class="keyword">return</span> installedModules[moduleId].<span class="property">exports</span>;</span><br><span class="line">            <span class="comment">/******/</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/******/</span> <span class="comment">// Create a new module (and put it into the cache)</span></span><br><span class="line">        <span class="comment">/******/</span> <span class="keyword">var</span> <span class="variable language_">module</span> = (installedModules[moduleId] = &#123;</span><br><span class="line">            <span class="comment">/******/</span> <span class="attr">i</span>: moduleId,</span><br><span class="line">            <span class="comment">/******/</span> <span class="attr">l</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="comment">/******/</span> <span class="attr">exports</span>: &#123;&#125;,</span><br><span class="line">            <span class="comment">/******/</span></span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">/******/</span></span><br><span class="line">        <span class="comment">/******/</span> <span class="comment">// Execute the module function</span></span><br><span class="line">        <span class="comment">/******/</span> modules[moduleId].<span class="title function_">call</span>(</span><br><span class="line">            <span class="variable language_">module</span>.<span class="property">exports</span>,</span><br><span class="line">            <span class="variable language_">module</span>,</span><br><span class="line">            <span class="variable language_">module</span>.<span class="property">exports</span>,</span><br><span class="line">            __webpack_require__</span><br><span class="line">        );</span><br><span class="line">        <span class="comment">/******/</span></span><br><span class="line">        <span class="comment">/******/</span> <span class="comment">// Flag the module as loaded</span></span><br><span class="line">        <span class="comment">/******/</span> <span class="variable language_">module</span>.<span class="property">l</span> = <span class="literal">true</span>;</span><br><span class="line">        <span class="comment">/******/</span></span><br><span class="line">        <span class="comment">/******/</span> <span class="comment">// Return the exports of the module</span></span><br><span class="line">        <span class="comment">/******/</span> <span class="keyword">return</span> <span class="variable language_">module</span>.<span class="property">exports</span>;</span><br><span class="line">        <span class="comment">/******/</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/******/</span></span><br><span class="line">    <span class="comment">/******/</span></span><br><span class="line">    <span class="comment">/******/</span> <span class="comment">// expose the modules object (__webpack_modules__)</span></span><br><span class="line">    <span class="comment">/******/</span> __webpack_require__.<span class="property">m</span> = modules;</span><br><span class="line">    <span class="comment">/******/</span></span><br><span class="line">    <span class="comment">/******/</span> <span class="comment">// expose the module cache</span></span><br><span class="line">    <span class="comment">/******/</span> __webpack_require__.<span class="property">c</span> = installedModules;</span><br><span class="line">    <span class="comment">/******/</span></span><br><span class="line">    <span class="comment">/******/</span> <span class="comment">// define getter function for harmony exports</span></span><br><span class="line">    <span class="comment">/******/</span> __webpack_require__.<span class="property">d</span> = <span class="keyword">function</span> (<span class="params"><span class="built_in">exports</span>, name, getter</span>) &#123;</span><br><span class="line">        <span class="comment">/******/</span> <span class="keyword">if</span> (!__webpack_require__.<span class="title function_">o</span>(<span class="built_in">exports</span>, name)) &#123;</span><br><span class="line">            <span class="comment">/******/</span> <span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(<span class="built_in">exports</span>, name, &#123;</span><br><span class="line">                <span class="comment">/******/</span> <span class="attr">configurable</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="comment">/******/</span> <span class="attr">enumerable</span>: <span class="literal">true</span>,</span><br><span class="line">                <span class="comment">/******/</span> <span class="attr">get</span>: getter,</span><br><span class="line">                <span class="comment">/******/</span></span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="comment">/******/</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/******/</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">/******/</span></span><br><span class="line">    <span class="comment">/******/</span> <span class="comment">// getDefaultExport function for compatibility with non-harmony modules</span></span><br><span class="line">    <span class="comment">/******/</span> __webpack_require__.<span class="property">n</span> = <span class="keyword">function</span> (<span class="params"><span class="variable language_">module</span></span>) &#123;</span><br><span class="line">        <span class="comment">/******/</span> <span class="keyword">var</span> getter =</span><br><span class="line">            <span class="variable language_">module</span> &amp;&amp; <span class="variable language_">module</span>.<span class="property">__esModule</span></span><br><span class="line">                ? <span class="comment">/******/</span> <span class="keyword">function</span> <span class="title function_">getDefault</span>(<span class="params"></span>) &#123;</span><br><span class="line">                      <span class="keyword">return</span> <span class="variable language_">module</span>[<span class="string">&quot;default&quot;</span>];</span><br><span class="line">                  &#125;</span><br><span class="line">                : <span class="comment">/******/</span> <span class="keyword">function</span> <span class="title function_">getModuleExports</span>(<span class="params"></span>) &#123;</span><br><span class="line">                      <span class="keyword">return</span> <span class="variable language_">module</span>;</span><br><span class="line">                  &#125;;</span><br><span class="line">        <span class="comment">/******/</span> __webpack_require__.<span class="title function_">d</span>(getter, <span class="string">&quot;a&quot;</span>, getter);</span><br><span class="line">        <span class="comment">/******/</span> <span class="keyword">return</span> getter;</span><br><span class="line">        <span class="comment">/******/</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">/******/</span></span><br><span class="line">    <span class="comment">/******/</span> <span class="comment">// Object.prototype.hasOwnProperty.call</span></span><br><span class="line">    <span class="comment">/******/</span> __webpack_require__.<span class="property">o</span> = <span class="keyword">function</span> (<span class="params">object, property</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">hasOwnProperty</span>.<span class="title function_">call</span>(object, property);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">/******/</span></span><br><span class="line">    <span class="comment">/******/</span> <span class="comment">// __webpack_public_path__</span></span><br><span class="line">    <span class="comment">/******/</span> __webpack_require__.<span class="property">p</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="comment">/******/</span></span><br><span class="line">    <span class="comment">/******/</span> <span class="comment">// Load entry module and return exports</span></span><br><span class="line">    <span class="comment">/******/</span> <span class="keyword">return</span> <span class="title function_">__webpack_require__</span>((__webpack_require__.<span class="property">s</span> = <span class="number">0</span>));</span><br><span class="line">    <span class="comment">/******/</span></span><br><span class="line">&#125;)(</span><br><span class="line">    <span class="comment">/************************************************************************/</span></span><br><span class="line">    <span class="comment">/******/</span> [</span><br><span class="line">        <span class="comment">/* 0 */</span></span><br><span class="line">        <span class="comment">/***/</span> <span class="keyword">function</span> (<span class="params"><span class="variable language_">module</span>, __webpack_exports__, __webpack_require__</span>) &#123;</span><br><span class="line">            <span class="string">&quot;use strict&quot;</span>;</span><br><span class="line">            <span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(__webpack_exports__, <span class="string">&quot;__esModule&quot;</span>, &#123;</span><br><span class="line">                <span class="attr">value</span>: <span class="literal">true</span>,</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="comment">/* harmony import */</span> <span class="keyword">var</span> __WEBPACK_IMPORTED_MODULE_0__foo__ =</span><br><span class="line">                <span class="title function_">__webpack_require__</span>(<span class="number">1</span>);</span><br><span class="line">            <span class="comment">// 这里用到了 __webpack_require__.n</span></span><br><span class="line">            <span class="comment">/* harmony import */</span> <span class="keyword">var</span> __WEBPACK_IMPORTED_MODULE_0__foo___default =</span><br><span class="line">                __webpack_require__.<span class="title function_">n</span>(__WEBPACK_IMPORTED_MODULE_0__foo__);</span><br><span class="line"></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(__WEBPACK_IMPORTED_MODULE_0__foo___default.<span class="property">a</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;我是高级前端工程师~&quot;</span>);</span><br><span class="line">            <span class="comment">/* harmony default export */</span> __webpack_exports__[<span class="string">&quot;default&quot;</span>] = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">            <span class="comment">/***/</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">/* 1 */</span></span><br><span class="line">        <span class="comment">/***/</span> <span class="keyword">function</span> (<span class="params"><span class="variable language_">module</span>, <span class="built_in">exports</span></span>) &#123;</span><br><span class="line">            <span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">                <span class="attr">name</span>: <span class="string">&quot;quanquan&quot;</span>,</span><br><span class="line">                <span class="attr">job</span>: <span class="string">&quot;fe&quot;</span>,</span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line">            <span class="comment">/***/</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">/******/</span></span><br><span class="line">    ]</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p><code>index.js</code> 没有变化, 也就是说当导出模块导出的语法为 commonjs 而导入模块的导入语法为 es6 时, 导入模块就会用到了 <code>__webpack_require__.n</code> 这个方法.</p><p>下集预告: 到这里一个纯 js 文件的打包结果就分析完了, webpack 巧妙的把所有的模块都打包到了一个 bundle.js 文件中从而实现同步加载模块, 实在高明. 但是, 如果你的项目很大, 动辄成百上千的 js 模块, 此时运用 webpack 又能怎样实现代码拆分呢? 我们下一步一起讨论.</p><p><img src="https://handle-note-img.niubishanshan.top/20240627232332.png" alt="20240627232332"></p></div><footer class="post-footer"><div class="post-tags"> <a href="/tags/blog/" rel="tag"># blog</a></div><div class="post-nav"><div class="post-nav-item"><a href="/blog/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E9%85%8D-webpack/blog/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E9%85%8D%20webpack/%E7%AC%AC%E4%B8%89%E6%AD%A5,%20%E9%A2%86%E5%AF%BC-%E4%B8%BA%E4%BB%80%E4%B9%88%E5%88%AB%E4%BA%BA%E5%AE%B6%E7%9A%84%20js%20%E6%96%87%E4%BB%B6%E9%82%A3%E4%B9%88%E5%B0%8F/" rel="prev" title="第三步, 领导-为什么别人家的 js 文件那么小"><i class="fa fa-chevron-left"></i> 第三步, 领导-为什么别人家的 js 文件那么小</a></div><div class="post-nav-item"> <a href="/blog/%E5%9F%BA%E7%A1%80%E5%88%86%E4%BA%AB/blog/%E5%9F%BA%E7%A1%80%E5%88%86%E4%BA%AB/%E6%96%B0%E6%89%8B%E7%90%86%E8%A7%A3%20apply%20%E5%92%8C%20call/" rel="next" title="新手理解 apply 和 call">新手理解 apply 和 call<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div></div><script>
  window.addEventListener('tabs:register', function() {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc"> 文章目录</li><li class="sidebar-nav-overview"> 站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B0%B4%E5%B0%AC%E7%9A%84%E9%9D%A2%E8%AF%95%E9%A2%98"><span class="nav-text">尴尬的面试题</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#webpack-%E5%88%B0%E5%BA%95%E5%81%9A%E4%BA%86%E4%BB%80%E4%B9%88"><span class="nav-text">webpack 到底做了什么</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#commonjs-%E6%A8%A1%E5%9D%97%E5%8C%96%E7%9A%84%E5%A4%84%E7%90%86"><span class="nav-text">commonjs 模块化的处理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#es6-Module-%E6%A8%A1%E5%9D%97%E5%8C%96%E7%9A%84%E5%A4%84%E7%90%86"><span class="nav-text">es6 Module 模块化的处理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#es6-Module-CommonJs-%E6%B7%B7%E5%90%88%E4%BD%BF%E7%94%A8"><span class="nav-text">es6 Module CommonJs 混合使用</span></a></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="圈圈的圈" src="/images/avatar.png"><p class="site-author-name" itemprop="name">圈圈的圈</p><div class="site-description" itemprop="description">技术学习, 读书笔记, 生活感悟 ~</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">142</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/"><span class="site-state-item-count">35</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">8</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://juejin.im/user/5837c2bd61ff4b006ca8d1b2" title="掘金 → https:&#x2F;&#x2F;juejin.im&#x2F;user&#x2F;5837c2bd61ff4b006ca8d1b2" rel="noopener" target="_blank"><i class="fa fa-fw fa-stack-overflow"></i> 掘金</a></span><span class="links-of-author-item"><a href="https://github.com/luoquanquan" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;luoquanquan" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="mailto:luo_quanquan@163.com" title="E-Mail → mailto:luo_quanquan@163.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i> E-Mail</a></span></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="beian"><a href="http://www.beian.miit.gov.cn/" rel="noopener" target="_blank">京ICP备17034706号-1</a></div><div class="copyright"> &copy; <span itemprop="copyrightYear">2024</span><span class="with-love"><i class="fa fa-user"></i></span> <span class="author" itemprop="copyrightHolder">圈圈的圈</span></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item" id="busuanzi_container_site_uv"><span class="post-meta-item-icon"><i class="fa fa-user"></i></span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span></span></span> <span class="post-meta-divider">|</span><span class="post-meta-item" id="busuanzi_container_site_pv"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div></div></footer></div><script color="0,0,255" opacity="0.5" zindex="-1" count="99" src="/js/theme-next-canvas-nest/canvas-nest.min.js"></script><script src="/lib/anime.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script></body></html>