<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png"><link rel="mask-icon" href="/images/logo.svg" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:new URL("http://note.niubishanshan.top").hostname,root:"/",scheme:"Gemini",version:"7.7.0",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!1,show_result:!1,style:null},back2top:{enable:!0,sidebar:!1,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{appID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},path:"search.json",motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}}}</script><meta name="description" content="本节视频 https:&#x2F;&#x2F;www.bilibili.com&#x2F;video&#x2F;BV1Vt411X7JF&#x2F;?p&#x3D;4 双花攻击 (double spending attack)数字货币本质上是带有签名的数据文件, 可以进行复制和备份. 也就是说, 我可以把自己的钱复制一份, 先花给一个人再把备份花给另外一个人. 传统的解决双花问题的方案, 数字货币的发行由中心化机构完成. 每次发行的货币都包含一个编号, 每"><meta property="og:type" content="article"><meta property="og:title" content="4. 比特币的共识协议"><meta property="og:url" content="http://note.niubishanshan.top/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%8A%80%E6%9C%AF%E4%B8%8E%E5%BA%94%E7%94%A8/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%8A%80%E6%9C%AF%E4%B8%8E%E5%BA%94%E7%94%A8/4.%20%E6%AF%94%E7%89%B9%E5%B8%81%E7%9A%84%E5%85%B1%E8%AF%86%E5%8D%8F%E8%AE%AE/index.html"><meta property="og:site_name" content="圈圈的笔记"><meta property="og:description" content="本节视频 https:&#x2F;&#x2F;www.bilibili.com&#x2F;video&#x2F;BV1Vt411X7JF&#x2F;?p&#x3D;4 双花攻击 (double spending attack)数字货币本质上是带有签名的数据文件, 可以进行复制和备份. 也就是说, 我可以把自己的钱复制一份, 先花给一个人再把备份花给另外一个人. 传统的解决双花问题的方案, 数字货币的发行由中心化机构完成. 每次发行的货币都包含一个编号, 每"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://handle-note-img.niubishanshan.top/20221202103659.png"><meta property="og:image" content="https://handle-note-img.niubishanshan.top/20221202113046.png"><meta property="og:image" content="https://handle-note-img.niubishanshan.top/20221229013211.png"><meta property="og:image" content="https://handle-note-img.niubishanshan.top/20230102184732.png"><meta property="og:image" content="https://handle-note-img.niubishanshan.top/20230102190524.png"><meta property="og:image" content="https://handle-note-img.niubishanshan.top/20230102191335.png"><meta property="og:image" content="https://handle-note-img.niubishanshan.top/20230102192931.png"><meta property="article:published_time" content="2022-12-01T13:40:31.000Z"><meta property="article:modified_time" content="2024-06-27T15:04:43.279Z"><meta property="article:author" content="圈圈的圈"><meta property="article:tag" content="笔记"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://handle-note-img.niubishanshan.top/20221202103659.png"><link rel="canonical" href="http://note.niubishanshan.top/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%8A%80%E6%9C%AF%E4%B8%8E%E5%BA%94%E7%94%A8/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%8A%80%E6%9C%AF%E4%B8%8E%E5%BA%94%E7%94%A8/4.%20%E6%AF%94%E7%89%B9%E5%B8%81%E7%9A%84%E5%85%B1%E8%AF%86%E5%8D%8F%E8%AE%AE/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0}</script><title>4. 比特币的共识协议 | 圈圈的笔记</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div> <a target="_blank" rel="noopener" href="https://github.com/luoquanquan" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513;color:#fff;position:absolute;top:0;border:0;right:0" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-meta"><div><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">圈圈的笔记</span><span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle">路漫漫其修远兮, 吾将上下而求索</p></div><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-fw fa-home"></i> 首页</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i> 标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i> 分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i> 归档</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i> 关于</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> 搜索</a></li></ul></nav><div class="site-search"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="搜索..." spellcheck="false" type="text" id="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"></div></div><div class="search-pop-overlay"></div></div></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content"><div class="posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="http://note.niubishanshan.top/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%8A%80%E6%9C%AF%E4%B8%8E%E5%BA%94%E7%94%A8/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%8A%80%E6%9C%AF%E4%B8%8E%E5%BA%94%E7%94%A8/4.%20%E6%AF%94%E7%89%B9%E5%B8%81%E7%9A%84%E5%85%B1%E8%AF%86%E5%8D%8F%E8%AE%AE/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.png"><meta itemprop="name" content="圈圈的圈"><meta itemprop="description" content="技术学习, 读书笔记, 生活感悟 ~"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="圈圈的笔记"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> 4. 比特币的共识协议</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2022-12-01 21:40:31" itemprop="dateCreated datePublished" datetime="2022-12-01T21:40:31+08:00">2022-12-01</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i></span> <span class="post-meta-item-text">更新于</span> <time title="修改时间：2024-06-27 23:04:43" itemprop="dateModified" datetime="2024-06-27T23:04:43+08:00">2024-06-27</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">学习笔记</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%8A%80%E6%9C%AF%E4%B8%8E%E5%BA%94%E7%94%A8/" itemprop="url" rel="index"><span itemprop="name">区块链技术与应用</span></a></span></span><span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">阅读次数：</span><span id="busuanzi_value_page_pv"></span></span></div></header><div class="post-body" itemprop="articleBody"><p>本节视频 <a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Vt411X7JF/?p=4">https://www.bilibili.com/video/BV1Vt411X7JF/?p=4</a></p><h2 id="双花攻击-double-spending-attack"><a href="#双花攻击-double-spending-attack" class="headerlink" title="双花攻击 (double spending attack)"></a>双花攻击 (double spending attack)</h2><p>数字货币本质上是带有签名的数据文件, 可以进行复制和备份. 也就是说, 我可以把自己的钱复制一份, 先花给一个人再把备份花给另外一个人.</p><p>传统的解决双花问题的方案, 数字货币的发行由中心化机构完成. 每次发行的货币都包含一个编号, 每次支付都要经过货币发行方的认证来查询真伪. 该方法依赖第三方机构来判断数字货币的真实性来解决双花问题, 是一个典型的中心化方案. 现实生活中 Alipay Wechat 应该用的就是类似的方案. 由于他们有比较高的可信度或者有政府背书, 即可采用这种方案…</p><p>然而, 有些场景下(如跨国交易). 并不存在这样可依赖的第三方机构. 此时以去中心化思想为核心的比特币便吸引了人们的注意…</p><span id="more"></span><h2 id="数字货币的发行❓"><a href="#数字货币的发行❓" class="headerlink" title="数字货币的发行❓"></a>数字货币的发行❓</h2><p>数字货币由谁发行? 通过怎样的方式发行? 发行的数量和时间?</p><p>在传统的货币体系中, 货币的发行由央行完成. 在去中心化的思想中各个节点平等, 没有了作为信用第三方的央行. 货币发行权的分配显得尤为重要.</p><blockquote><p>在比特币系统中由挖矿来决定货币发行权和发行量</p></blockquote><h2 id="怎样验证交易的有效性-解决双花攻击❓"><a href="#怎样验证交易的有效性-解决双花攻击❓" class="headerlink" title="怎样验证交易的有效性, 解决双花攻击❓"></a>怎样验证交易的有效性, 解决双花攻击❓</h2><p>没有了可信任的中心化第三方机构后, 比特币系统中通过全体用户共同维护一个区块链的数据结构来记录货币的使用情况保证交易的有效性.</p><p><img src="https://handle-note-img.niubishanshan.top/20221202103659.png" alt="20221202103659"></p><p>如上图, 假定 A 获得铸币权 (Create Coin) 并且通过铸币交易(coinbase tx)发布了 10 个比特币.</p><ul><li>A 将 10 个比特币分别转给了 B(5 个比特币), C(5 个比特币). A 对该交易进行了签名并且指明了该交易所花比特币的来源 - 来自铸币交易</li><li>B 将自己的 5 个比特币转给 C(2 个比特币), D(3 个比特币). B 对交易进行签名并且指明了该交易所花比特币的来源 - 来自第一笔交易</li><li>C 将自己的比特币转给 E(7 个比特币), C 对该交易进行了签名并且指明了该交易所花比特币的来源 - 来自第一笔交易 + 第二笔交易</li></ul><p>图中有两种类型的指针:</p><ul><li>一种是链接各个区块的把各个区块串联成了一个完整的链表.</li><li>还有一种是指向前面某个交易的指针, 用来说明币的来源而非凭空捏造(或复制)的. 这样就可以防止双花攻击.</li></ul><p>在比特币系统中, 通过执行脚本实现上述验证过程. 将当前交易输入脚本与前一个交易输出脚本(说明币的来源的交易) 拼接执行, 如果可以正确执行, 说明交易合法</p><h2 id="区块信息"><a href="#区块信息" class="headerlink" title="区块信息"></a>区块信息</h2><p>节点类型:</p><ul><li>full node (fully validating node)</li><li>light node (无法独立验证交易的合法性)</li></ul><table><thead><tr><th>block header(区块链宏观信息)</th><th>block body</th></tr></thead><tbody><tr><td>version(版本)</td><td>交易列表</td></tr><tr><td>Hash of previous block header(指向前一个区块指针)</td><td>交易列表</td></tr><tr><td>Merkle root hash(默克尔树根哈希值)</td><td>交易列表</td></tr><tr><td>target(挖矿难度目标阈值)</td><td>交易列表</td></tr><tr><td>nonce(随机数)</td><td>交易列表</td></tr></tbody></table><ul><li>挖矿过程中求解的问题: H(block header) &lt;&#x3D; target</li><li>其中前一个区块的哈希只算前一区块的块头, Merkle root hash 保证了区块体内容不会被篡改, 所以只需要记录 block header 就能保证整个区块链不会被篡改<br><img src="https://handle-note-img.niubishanshan.top/20221202113046.png" alt="20221202113046"></li><li>区块链系统中, 轻节点只存储区块block header信息, 不参与区块链系统维护和构造, 也无法独立验证交易的合法性.</li></ul><h2 id="分布式共识-distributed-consensus"><a href="#分布式共识-distributed-consensus" class="headerlink" title="分布式共识 (distributed consensus)"></a>分布式共识 (distributed consensus)</h2><p>distributed hash table, 系统中很多机器共同维护一份哈希表.</p><p>可不可以各个节点独立完成区块链的构建?</p><p>显然是不行的, 各个节点独立打包交易形成区块链. 无法避免不同的节点生成的区块链不一致. 从分布式系统的角度考虑的话, 账本内容需要取得分布式共识. 从而保证区块链内容在不同节点上的一致性.</p><h3 id="impossibility-result"><a href="#impossibility-result" class="headerlink" title="impossibility result"></a>impossibility result</h3><p><strong>FLP impossibility result</strong>: 再一个异步系统中, 网络传输延迟没有上限. 哪怕系统中只有一个成员是异常成员. 整个系统也不能达成共识.</p><p><strong>CAP Theorem</strong>: Consistency 一致性, Availability 可靠性, Partition tolerance 容错性. 再任何一个分布式系统中最多只能满足其中两个性质.</p><p><img src="https://handle-note-img.niubishanshan.top/20221229013211.png" alt="20221229013211"></p><p>分布式共识中协议 Paxos 可以保证 Consistency 若达成共识必然一致. 但是在某种特殊情况下可能无法达成共识.</p><h2 id="比特币共识协议-Consensus-in-BitCoin"><a href="#比特币共识协议-Consensus-in-BitCoin" class="headerlink" title="比特币共识协议 (Consensus in BitCoin)"></a>比特币共识协议 (Consensus in BitCoin)</h2><blockquote><p>假设系统中存在部分恶意节点, 但是存在的比例很小. 大多数节点都是 “好” 的节点, 这种情况下进行共识协议设置.</p></blockquote><h3 id="直接投票"><a href="#直接投票" class="headerlink" title="直接投票"></a>直接投票</h3><p>某个节点打包交易得到区块, 将其发给其他节点. 其他节点检查区块, 如果内容正确则投出赞成票. 如果票数过半加入区块链.</p><h4 id="存在的问题"><a href="#存在的问题" class="headerlink" title="存在的问题"></a>存在的问题</h4><ol><li>恶意节点不断打包不合法的区块, 导致一直无法达成共识, 时间全部花费在验证上交易无法完成</li><li>没有强迫投票的手段, 某些节点可能恶意不投票</li><li>网络延迟事先未知, 无法确定投票的实现. 影响效率</li><li>membership, 如果是联盟链对于加入的成员有要求可以基于投票.但是比特币系统中任何人都可以加入, 而且创建账户非常简单. 黑客可以创建非常多的账户(公私钥对), 当数量达到比特币系统中的一半以上的时候就可以获得系统中的支配地位(女巫攻击 Sybil Attack).</li></ol><p>综上所述, 投票的方案是不可行的.</p><h3 id="基于算力投票"><a href="#基于算力投票" class="headerlink" title="基于算力投票"></a>基于算力投票</h3><blockquote><p>鉴于基于账户直接投票的方式存在上述的诸多问题, 比特币系统采用了另外一种投票的方式 - 基于算力的投票</p></blockquote><p>在比特币系统中, 每个节点都可以自行组装一个候选区块, 而后尝试各种 nonce 值使得 H(block header) &lt; target 这个过程就是挖矿. 当节点找到合法的 nonce 便算作是获取了<strong>记账权</strong>, 而后将该节点发布到区块链系统中. 其他节点收到候选区块后会验证区块的合法性. 如果候选区块得到了系统中多数节点的验证就会被加入到区块链中.</p><p>求解 nonce 的过程是 puzzle friendly 的过程, 前一次计算的结果不会对后一次计算有任何帮助. 所以每个节点都需要通过不断地尝试 nonce 来争夺记账权. 假设有两个节点, 节点 A 的算力是 B 的 10 倍. 那么在相同时间内节点 A 就有 10 倍与 B 的可能性算出合适的 nonce. 这种理论上算力大就能更优先的获取记账权的方式被称为基于算力的投票.</p><p><img src="https://handle-note-img.niubishanshan.top/20230102184732.png" alt="20230102184732"></p><h4 id="可能存在的问题"><a href="#可能存在的问题" class="headerlink" title="可能存在的问题"></a>可能存在的问题</h4><h5 id="forking-attack-分叉攻击"><a href="#forking-attack-分叉攻击" class="headerlink" title="forking attack(分叉攻击)"></a>forking attack(分叉攻击)</h5><blockquote><p>通过往区块链中间位置插入一个区块. 实现回滚某个已经发生了的交易</p></blockquote><p>假设一个获得记账权的节点发布了一个合法的区块, 但是它是插在中间位置的(基于hash of prev block). 如下图, A 给 B 转了 BTC, 但是 A 又转给自己相同的钱, 并且构造了新的区块回滚了转钱给 B 的交易. 但是 A -&gt; A’ 的交易并没有在<strong>最长合法链</strong>上, 所以不会被系统中的其他节点认可</p><p><img src="https://handle-note-img.niubishanshan.top/20230102190524.png" alt="20230102190524"></p><h5 id="合法的区块被拒绝"><a href="#合法的区块被拒绝" class="headerlink" title="合法的区块被拒绝"></a>合法的区块被拒绝</h5><p>如果两个节点同时获得记账权(几乎相同的时间), 就会出现两个等长的分叉. 按照最长合法链的原则两个区块都在最长的合法链上. 不同节点会根据自己最先接收到的区块作为最新块进行下一个区块的开发. 所以区块链系统中会暂时保存分叉的情况. 随着时间的推移必然会出现某条分叉变成最长的合法链, 这样就可能导致合法的区块也被拒绝.</p><p><img src="https://handle-note-img.niubishanshan.top/20230102191335.png" alt="20230102191335"></p><h2 id="争夺记账权"><a href="#争夺记账权" class="headerlink" title="争夺记账权"></a>争夺记账权</h2><blockquote><p>比特币系统引入了激励机制, 每个获取记账权的节点在区块成功上链后就会获取一份出块奖励. 除了节点打包的一堆交易之外还会添加一笔新的交易即铸币交易. 铸币交易也作为产生新的比特币的唯一途径.</p></blockquote><p>对于铸币交易产生的新的比特币的数量, 在比特币系统中也有明确规定. 起初每次出块奖励比特币 50 个, 字后每隔 21 万个区块出块奖励就会减半.</p><p><img src="https://handle-note-img.niubishanshan.top/20230102192931.png" alt="20230102192931"></p><p>除了铸币交易中获得的新 BTC 外, 节点在打包交易过程中还会取得交易的手续费(gas). 所以对于用户而言, 交易的输入是 &gt;&#x3D; 输出的. 差值就是交给节点的手续费.</p><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul><li><a target="_blank" rel="noopener" href="https://my.oschina.net/u/150175/blog/2992187">分布式理论：深入浅出 Paxos 算法</a></li></ul></div><footer class="post-footer"><div class="post-tags"> <a href="/tags/%E7%AC%94%E8%AE%B0/" rel="tag"># 笔记</a></div><div class="post-nav"><div class="post-nav-item"><a href="/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%8A%80%E6%9C%AF%E4%B8%8E%E5%BA%94%E7%94%A8/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%8A%80%E6%9C%AF%E4%B8%8E%E5%BA%94%E7%94%A8/3.%20%E6%AF%94%E7%89%B9%E5%B8%81%E7%9A%84%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" rel="prev" title="3. 比特币的数据结构"><i class="fa fa-chevron-left"></i> 3. 比特币的数据结构</a></div><div class="post-nav-item"> <a href="/%E5%BC%80%E5%8F%91%E7%AC%94%E8%AE%B0/web3/MetaMask-%E6%BA%90%E7%A0%81/%E5%BC%80%E5%8F%91%E7%AC%94%E8%AE%B0/web3/MetaMask%20%E6%BA%90%E7%A0%81/%E5%B0%8F%E7%8B%90%E7%8B%B8%E4%BE%9D%E8%B5%96-eth-ledger-bridge-keyring/" rel="next" title="小狐狸依赖-eth-ledger-bridge-keyring">小狐狸依赖-eth-ledger-bridge-keyring<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div></div><script>
  window.addEventListener('tabs:register', function() {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc"> 文章目录</li><li class="sidebar-nav-overview"> 站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%8C%E8%8A%B1%E6%94%BB%E5%87%BB-double-spending-attack"><span class="nav-text">双花攻击 (double spending attack)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E5%AD%97%E8%B4%A7%E5%B8%81%E7%9A%84%E5%8F%91%E8%A1%8C%E2%9D%93"><span class="nav-text">数字货币的发行❓</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%8E%E6%A0%B7%E9%AA%8C%E8%AF%81%E4%BA%A4%E6%98%93%E7%9A%84%E6%9C%89%E6%95%88%E6%80%A7-%E8%A7%A3%E5%86%B3%E5%8F%8C%E8%8A%B1%E6%94%BB%E5%87%BB%E2%9D%93"><span class="nav-text">怎样验证交易的有效性, 解决双花攻击❓</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8C%BA%E5%9D%97%E4%BF%A1%E6%81%AF"><span class="nav-text">区块信息</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%86%E5%B8%83%E5%BC%8F%E5%85%B1%E8%AF%86-distributed-consensus"><span class="nav-text">分布式共识 (distributed consensus)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#impossibility-result"><span class="nav-text">impossibility result</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%AF%94%E7%89%B9%E5%B8%81%E5%85%B1%E8%AF%86%E5%8D%8F%E8%AE%AE-Consensus-in-BitCoin"><span class="nav-text">比特币共识协议 (Consensus in BitCoin)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9B%B4%E6%8E%A5%E6%8A%95%E7%A5%A8"><span class="nav-text">直接投票</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AD%98%E5%9C%A8%E7%9A%84%E9%97%AE%E9%A2%98"><span class="nav-text">存在的问题</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E4%BA%8E%E7%AE%97%E5%8A%9B%E6%8A%95%E7%A5%A8"><span class="nav-text">基于算力投票</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%AF%E8%83%BD%E5%AD%98%E5%9C%A8%E7%9A%84%E9%97%AE%E9%A2%98"><span class="nav-text">可能存在的问题</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#forking-attack-%E5%88%86%E5%8F%89%E6%94%BB%E5%87%BB"><span class="nav-text">forking attack(分叉攻击)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%90%88%E6%B3%95%E7%9A%84%E5%8C%BA%E5%9D%97%E8%A2%AB%E6%8B%92%E7%BB%9D"><span class="nav-text">合法的区块被拒绝</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%89%E5%A4%BA%E8%AE%B0%E8%B4%A6%E6%9D%83"><span class="nav-text">争夺记账权</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"><span class="nav-text">参考资料</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="圈圈的圈" src="/images/avatar.png"><p class="site-author-name" itemprop="name">圈圈的圈</p><div class="site-description" itemprop="description">技术学习, 读书笔记, 生活感悟 ~</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">142</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/"><span class="site-state-item-count">35</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">8</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://juejin.im/user/5837c2bd61ff4b006ca8d1b2" title="掘金 → https:&#x2F;&#x2F;juejin.im&#x2F;user&#x2F;5837c2bd61ff4b006ca8d1b2" rel="noopener" target="_blank"><i class="fa fa-fw fa-stack-overflow"></i> 掘金</a></span><span class="links-of-author-item"><a href="https://github.com/luoquanquan" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;luoquanquan" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="mailto:luo_quanquan@163.com" title="E-Mail → mailto:luo_quanquan@163.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i> E-Mail</a></span></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="beian"><a href="http://www.beian.miit.gov.cn/" rel="noopener" target="_blank">京ICP备17034706号-1</a></div><div class="copyright"> &copy; <span itemprop="copyrightYear">2024</span><span class="with-love"><i class="fa fa-user"></i></span> <span class="author" itemprop="copyrightHolder">圈圈的圈</span></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item" id="busuanzi_container_site_uv"><span class="post-meta-item-icon"><i class="fa fa-user"></i></span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span></span></span> <span class="post-meta-divider">|</span><span class="post-meta-item" id="busuanzi_container_site_pv"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div></div></footer></div><script color="0,0,255" opacity="0.5" zindex="-1" count="99" src="/js/theme-next-canvas-nest/canvas-nest.min.js"></script><script src="/lib/anime.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script></body></html>